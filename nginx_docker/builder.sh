# ---------------------------------------------------------------------------------------
# @ Settings
# ---------------------------------------------------------------------------------------
FILE=$(basename "$0")
BASE_DIR=$(basename "$(realpath "$0" | xargs dirname)")

# ---------------------------------------------------------------------------------------
# @ Main Application
# ---------------------------------------------------------------------------------------
main() {
    docker_build $BASE_DIR 
    docker_runner $BASE_DIR 
}

# ---------------------------------------------------------------------------------------
# @ Methods
# ---------------------------------------------------------------------------------------
docker_build(){
    rm -rf build/
    mkdir build/
    docker build -t $1 . && docker save $1 | gzip > build/container.tar.gz
}

docker_runner(){
    docker run -p 8080:80 --rm $1
}

# ---------------------------------------------------------------------------------------
# @ Execute
# ---------------------------------------------------------------------------------------
main